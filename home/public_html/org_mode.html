<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-08-21 Wed 13:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Notes for org-mode</title>
<meta name="author" content="Alex" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet"
             href="./css/fb.css" type="text/css"/>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Notes for org-mode</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org9cf511f">1. shortcuts</a></li>
<li><a href="#orge755e57">2. Math/Latex</a>
<ul>
<li><a href="#orgc5942d2">2.1. superscript/subscript, square root</a></li>
<li><a href="#orged9c1c7">2.2. Matix</a></li>
<li><a href="#orgfd0e27e">2.3. '\|' for ||</a></li>
</ul>
</li>
<li><a href="#org9ae125a">3. work with images on Windows</a></li>
</ul>
</div>
</div>


<div id="outline-container-org9cf511f" class="outline-2">
<h2 id="org9cf511f"><span class="section-number-2">1.</span> shortcuts</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>C-c C-x \ : runs the command org-toggle-pretty-entities</li>
</ul>
</div>
</div>

<div id="outline-container-orge755e57" class="outline-2">
<h2 id="orge755e57"><span class="section-number-2">2.</span> Math/Latex</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgc5942d2" class="outline-3">
<h3 id="orgc5942d2"><span class="section-number-3">2.1.</span> superscript/subscript, square root</h3>
<div class="outline-text-3" id="text-2-1">
<p>
If \(a^2=b\) and \( b=2 \), then the solution must be
either \[ a=+\sqrt{2} \] or \[ a=-\sqrt{2} \].
</p>
</div>
</div>

<div id="outline-container-orged9c1c7" class="outline-3">
<h3 id="orged9c1c7"><span class="section-number-3">2.2.</span> Matix</h3>
<div class="outline-text-3" id="text-2-2">
\begin{matrix}
 a & b \\
 c & d \\
\end{matrix}

\begin{pmatrix} 
  \alpha     & \beta^{*}\\ 
  \gamma^{*} & \delta 
\end{pmatrix}

\begin{bmatrix} 
  \alpha     & \beta^{*}\\ 
  \gamma^{*} & \delta 
\end{bmatrix}


<p>
\(X =
\begin{array}{cc}
x & y \\
z & w \\
\end{array}\)
</p>


<p>
\(M = \left( \begin{smallmatrix} a&b\\ c&d \end{smallmatrix} \right)\)
</p>

<ul class="org-ul">
<li>matrix: unbracketed matrix</li>
<li>pmatrix: matrix surrounded by parentheses</li>
<li>bmatrix: matrix surrounded by square brackets</li>
<li>vmatrix: matrix surrounded by single vertical lines</li>
<li>Vmatrix: matrix surrounded by double vertical lines</li>
</ul>
</div>
</div>

<div id="outline-container-orgfd0e27e" class="outline-3">
<h3 id="orgfd0e27e"><span class="section-number-3">2.3.</span> '\|' for ||</h3>
<div class="outline-text-3" id="text-2-3">
<p>
\(\|a\|\)<sup>2</sup> = a * a
</p>
</div>
</div>
</div>

<div id="outline-container-org9ae125a" class="outline-2">
<h2 id="org9ae125a"><span class="section-number-2">3.</span> work with images on Windows</h2>
<div class="outline-text-2" id="text-3">
<pre class="example" id="org9b2e6c1">

I'm glad to hear that it's working now! Besides adding the debugging messages, the main changes I made to the function were:

1. **Escaping Backslashes**: Ensuring that backslashes in file paths are properly escaped. This is important for Windows file paths in Emacs Lisp. For example, I replaced `/` with `\\` in the `replace-regexp-in-string` function.

2. **Concatenation of Strings**: Making sure that the `concat` function is used correctly to concatenate strings, especially when constructing the `filename` and the command string.

Here is the revised function with the changes highlighted:

```elisp
(defun org-screenshot ()
  "Take a screenshot into a time stamped unique-named file in the same 
directory as the org-buffer and insert
a link to this file."
  (interactive)
  (create-directory-if-not-exists org-download-image-dir)

  (setq tilde-buffer-filename
        (replace-regexp-in-string "/" "\\\\" (buffer-file-name) t t)) ;; Escaping backslashes
  (setq filename
        (concat
         (make-temp-name
          (concat org-download-image-dir
                  "_"
                  (format-time-string "%Y%m%d_%H%M%S_"))) ".jpg")) ;; Correct concatenation
  ;; Debugging: Print the filename to the *Messages* buffer
  (message "Saving screenshot to: %s" filename)

  ;; Linux: ImageMagick: (call-process "import" nil nil nil filename)

  ;; (shell-command "powershell.exe snippingtool /clip")
  (my-org-download-set-dir)
  (org-download-screenshot)
  ;; Windows: Irfanview
  (let ((command (concat "C:\\Users\\axu\\bin\\iview467_x64\\i_view64.exe /clippaste /convert=\"" filename "\""))) ;; Correct concatenation
    ;; Debugging: Print the command to the *Messages* buffer
    (message "Executing command: %s" command)
    (call-process-shell-command command))
  (insert (concat "[[file:" filename "]]"))
  (org-display-inline-images))
```

These changes ensure that the file paths are correctly formatted and that the command to save the image is constructed properly. If you have any more questions or need further assistance, feel free to ask!
</pre>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alex</p>
<p class="date">Created: 2024-08-21 Wed 13:12</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
